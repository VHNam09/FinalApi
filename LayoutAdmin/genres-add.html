<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../assets/css/admin/movies.css" />
    <link rel="stylesheet" href="../assets/css/admin/genres-add.css" />
    <title>NOTFLEX Admin - Th√™m Th·ªÉ lo·∫°i</title>

</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="menu-toggle">‚ò∞</div>
        <a href="dashboard.html" class="logo">NOTFLEX</a>
        <div class="header-title">Th√™m Th·ªÉ lo·∫°i</div>
        <div class="user-menu">
            <a href="#">Admin</a>
            <a href="#">ƒêƒÉng xu·∫•t</a>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <nav class="sidebar-menu">
                <div class="menu-title">Qu·∫£n l√Ω n·ªôi dung</div>
                <a href="dashboard.html" class="menu-item">
                    <i class="fa fa-dashboard">üìä</i> Dashboard
                </a>
                <a href="movies.html" class="menu-item">
                    <i class="fa fa-film">üé¨</i> Phim
                </a>
                <a href="genres.html" class="menu-item active">
                    <i class="fa fa-tags">üè∑Ô∏è</i> Th·ªÉ lo·∫°i
                </a>

                <div class="menu-title">Qu·∫£n l√Ω ng∆∞·ªùi d√πng</div>
                <a href="users.html" class="menu-item">
                    <i class="fa fa-users">üë•</i> Users
                </a>
                <a href="roles.html" class="menu-item">
                    <i class="fa fa-lock">üîí</i> Role
                </a>

                <!-- <div class="menu-title">H·ªá th·ªëng</div>
                <a href="settings.html" class="menu-item">
                    <i class="fa fa-cog">‚öôÔ∏è</i> C√†i ƒë·∫∑t
                </a>
                <a href="statistics.html" class="menu-item">
                    <i class="fa fa-bar-chart">üìà</i> Th·ªëng k√™
                </a> -->
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="page-title">
                <h1>Th√™m Th·ªÉ lo·∫°i m·ªõi</h1>
                <a href="genres.html" class="btn btn-cancel">Quay l·∫°i danh s√°ch</a>
            </div>

            <div class="form-container">
                <div class="form-title">Th√¥ng tin th·ªÉ lo·∫°i</div>
                <form id="addGenreForm">
                    <div class="form-group">
                        <label for="name" class="required-field">T√™n th·ªÉ lo·∫°i</label>
                        <input type="text" id="name" class="form-control" placeholder="Nh·∫≠p t√™n th·ªÉ lo·∫°i" required>
                        <div id="name-error" class="error-message">Vui l√≤ng nh·∫≠p t√™n th·ªÉ lo·∫°i</div>
                    </div>

                    <div class="form-group">
                        <label for="description" class="required-field">M√¥ t·∫£</label>
                        <textarea id="description" class="form-control" rows="4" placeholder="Nh·∫≠p m√¥ t·∫£ th·ªÉ lo·∫°i"
                            required></textarea>
                        <div id="description-error" class="error-message">Vui l√≤ng nh·∫≠p m√¥ t·∫£ th·ªÉ lo·∫°i</div>
                    </div>

                    <div class="form-actions">
                        <button type="button" id="cancelButton" class="btn btn-cancel">H·ªßy</button>
                        <button type="submit" id="submitButton" class="btn btn-submit">Th√™m th·ªÉ lo·∫°i</button>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <!-- <script src="../assets/js/admin/genres-add.js">

    </script> -->
    <script>
        function addGenre() {
            const apiUrl = 'https://localhost:7186/api/Genres';
            const nameInput = document.getElementById('name');
            const descriptionInput = document.getElementById('description');
            const submitButton = document.getElementById('submitButton');

            // T·∫°o payload t·ª´ form
            const genreData = {
                name: nameInput.value.trim(),
                description: descriptionInput.value.trim()
            };

            // Disable n√∫t submit trong khi x·ª≠ l√Ω
            submitButton.disabled = true;
            submitButton.textContent = 'ƒêang x·ª≠ l√Ω...';

            fetch(apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(genreData)
            })
                .then(response => {
                    if (!response.ok) {
                        return response.json().then(err => { throw err; });
                    }
                    return response.json();
                })
                .then(data => {
                    alert('Th√™m th·ªÉ lo·∫°i th√†nh c√¥ng!');
                    window.location.href = 'genres.html'; // Chuy·ªÉn h∆∞·ªõng sau khi th√†nh c√¥ng
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert(error.message || 'C√≥ l·ªói x·∫£y ra khi th√™m th·ªÉ lo·∫°i');
                })
                .finally(() => {
                    submitButton.disabled = false;
                    submitButton.textContent = 'Th√™m th·ªÉ lo·∫°i';
                });
        }

        // G·∫Øn s·ª± ki·ªán cho form
        document.getElementById('addGenreForm').addEventListener('submit', function (e) {
            e.preventDefault();
            addGenre();
        });

        // X·ª≠ l√Ω n√∫t h·ªßy
        document.getElementById('cancelButton').addEventListener('click', function () {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën h·ªßy thao t√°c n√†y?')) {
                window.location.href = 'genres.html';
            }
        });
    </script>
</body>

</html>